<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Yade-commits] r1106 - branches/scons-layout/scripts
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/yade-commits/2007/index.html" >
   <LINK REL="made" HREF="mailto:yade-commits%40lists.berlios.de?Subject=Re%3A%20%5BYade-commits%5D%20r1106%20-%20branches/scons-layout/scripts&In-Reply-To=%3C200703071316.l27DG16C014525%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000072.html">
   <LINK REL="Next"  HREF="000073.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Yade-commits] r1106 - branches/scons-layout/scripts</H1>
    <B>eudoxos at BerliOS</B> 
    <A HREF="mailto:yade-commits%40lists.berlios.de?Subject=Re%3A%20%5BYade-commits%5D%20r1106%20-%20branches/scons-layout/scripts&In-Reply-To=%3C200703071316.l27DG16C014525%40sheep.berlios.de%3E"
       TITLE="[Yade-commits] r1106 - branches/scons-layout/scripts">eudoxos at mail.berlios.de
       </A><BR>
    <I>Wed Mar  7 14:16:01 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000072.html">[Yade-commits] r1105 - in branches/scons-layout: . core extra extra/clump extra/spherical-dem-simulator gui gui/qt lib lib/computational-geometry lib/factory lib/multimethods lib/opengl lib/serialization lib/serialization-bin lib/serialization-qt lib/serialization-xml pkg/common pkg/common/Container/BodyContainer/BodyAssocVector pkg/common/Container/BodyContainer/BodyRedirectionVector pkg/common/Container/InteractionContainer/InteractionHashMap pkg/common/Container/InteractionContainer/InteractionVecSet pkg/common/Container/PhysicalActionContainer/PhysicalActionVectorVector pkg/common/DataClass/BoundingVolume/AABB pkg/common/DataClass/BoundingVolume/BoundingSphere pkg/common/DataClass/GeometricalModel/Box pkg/common/DataClass/GeometricalModel/Mesh2D pkg/common/DataClass/GeometricalModel/Quadrilateral pkg/common/DataClass/GeometricalModel/Sphere pkg/common/DataClass/GeometricalModel/Tetrahedron pkg/common/DataClass/InteractingGeometry/InteractingBox pkg/common/DataClass/Interacting! Geometry/InteractingSphere pkg/common/DataClass/InteractingGeometry/MetaInteractingGeometry pkg/common/DataClass/InteractionGeometry/ClosestFeatures pkg/common/DataClass/InteractionPhysics/SimpleElasticInteraction pkg/common/DataClass/PhysicalAction/Force pkg/common/DataClass/PhysicalAction/Momentum pkg/common/DataClass/PhysicalParameters/ParticleParameters pkg/common/DataClass/PhysicalParameters/RigidBodyParameters pkg/common/Engine/DeusExMachina/DisplacementEngine pkg/common/Engine/DeusExMachina/ForceEngine pkg/common/Engine/DeusExMachina/GravityEngine pkg/common/Engine/DeusExMachina/RotationEngine pkg/common/Engine/DeusExMachina/TranslationEngine pkg/common/Engine/EngineUnit/ElasticBodySimpleRelationship pkg/common/Engine/EngineUnit/LeapFrogOrientationIntegrator pkg/common/Engine/EngineUnit/LeapFrogPositionIntegrator pkg/common/Engine/EngineUnit/MetaInteractingGeometry2AABB pkg/common/Engine/EngineUnit/NewtonsMomentumLaw pkg/common/Engine/MetaEngine/BoundingVolumeMetaEng! ine pkg/common/Engine/MetaEngine/GeometricalModelMetaEngine pk! g/common
</A></li>
        <LI>Next message: <A HREF="000073.html">[Yade-commits] r1107 - in branches/scons-layout: extra gui pkg/common pkg/common/Container pkg/common/Container/BodyContainer/BodyAssocVector pkg/common/Container/BodyContainer/BodyRedirectionVector pkg/common/Container/InteractionContainer/InteractionHashMap pkg/common/Container/InteractionContainer/InteractionVecSet pkg/common/Container/PhysicalActionContainer/PhysicalActionVectorVector pkg/common/DataClass/BoundingVolume pkg/common/DataClass/BoundingVolume/AABB pkg/common/DataClass/BoundingVolume/BoundingSphere pkg/common/DataClass/GeometricalModel pkg/common/DataClass/GeometricalModel/Box pkg/common/DataClass/GeometricalModel/Mesh2D pkg/common/DataClass/GeometricalModel/Quadrilateral pkg/common/DataClass/GeometricalModel/Sphere pkg/common/DataClass/GeometricalModel/Tetrahedron pkg/common/DataClass/InteractingGeometry pkg/common/DataClass/InteractingGeometry/InteractingBox pkg/common/DataClass/InteractingGeometry/InteractingSphere pkg/common/DataClass/InteractingGeometry/MetaIn! teractingGeometry pkg/common/DataClass/InteractionGeometry pkg/common/DataClass/InteractionGeometry/ClosestFeatures pkg/common/DataClass/InteractionPhysics pkg/common/DataClass/InteractionPhysics/SimpleElasticInteraction pkg/common/DataClass/PhysicalAction pkg/common/DataClass/PhysicalAction/Force pkg/common/DataClass/PhysicalAction/Momentum pkg/common/DataClass/PhysicalParameters pkg/common/DataClass/PhysicalParameters/ElasticBodyParameters pkg/common/DataClass/PhysicalParameters/ParticleParameters pkg/common/DataClass/PhysicalParameters/RigidBodyParameters pkg/common/Engine/DeusExMachina pkg/common/Engine/DeusExMachina/DisplacementEngine pkg/common/Engine/DeusExMachina/ForceEngine pkg/common/Engine/DeusExMachina/GravityEngine pkg/common/Engine/DeusExMachina/RotationEngine pkg/common/Engine/DeusExMachina/TranslationEngine pkg/common/Engine/EngineUnit pkg/common/Engine/EngineUnit/CundallNonViscousForceDamping pkg/common/Engine/EngineUnit/CundallNonViscousMomentumDamping pkg! /common/Engine/EngineUnit/ElasticBodySimpleRelationship pkg/co! mmon/Eng
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67">[ date ]</a>
              <a href="thread.html#67">[ thread ]</a>
              <a href="subject.html#67">[ subject ]</a>
              <a href="author.html#67">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: eudoxos
Date: 2007-03-07 14:16:01 +0100 (Wed, 07 Mar 2007)
New Revision: 1106

Added:
   branches/scons-layout/scripts/ysl1.py
Log:
scriptto flatten tree.


Added: branches/scons-layout/scripts/ysl1.py
===================================================================
--- branches/scons-layout/scripts/ysl1.py	2007-03-07 12:02:48 UTC (rev 1105)
+++ branches/scons-layout/scripts/ysl1.py	2007-03-07 13:16:01 UTC (rev 1106)
@@ -0,0 +1,77 @@
+#!/usr/bin/env python
+# -*- coding: utf-8 -*-
+
+
+# 1. Move all files (.*)/([^/]*)/src/\2/(.*)$ -&gt; \1/\3 using svn
+# 2. Rename all directories named yade-([a-z]+)-([a-z]+) -&gt; \2 using svn
+
+action=['*/src/*','*/src','yade-*-*','pkg-*/*/*/*'][3]
+import re,os
+#import pysvn
+#client = pysvn.Client()
+
+dd=open('/tmp/d','w')
+emptyDirs=[]
+for root, dirs, files in os.walk('..'):
+	for d in ('.svn','yade-flat','include'):
+		try: dirs.remove(d)
+		except ValueError: pass
+	for d in dirs:	emptyDirs.append(d)
+	for f in files+dirs:
+		rootf=root+'/'+f
+		if action=='*/src/*':
+			m=re.match(r'(.*)/([^/]*)/src/\2/(.*)$',rootf)
+			if m:
+				newFile=m.group(1)+'/'+m.group(2)+'/'+m.group(3)
+				#client.move(rootf,newFile)
+				os.system('svn move %s %s'%(rootf,newFile))
+				dd.write(root+'\n')
+		elif action=='*/src':
+			m=re.match(r'(.*)/([^/]*)/src/([^/]*)$',rootf)
+			if m:
+				newFile=m.group(1)+'/'+m.group(2)+'/'+m.group(3)
+				#client.move(rootf.newFile)
+				os.system('svn move %s %s'%(rootf,newFile))
+				#print rootf,newFile
+		elif action=='yade-*-*':
+			m=re.match(r'(.*)/yade-([a-z]+)-([a-z-]+)$',rootf)
+			if m:
+				newDir=m.group(1)+'/'+m.group(3)
+				if m.group(3)=='dem-simulator': newDir=m.group(1)+'/spherical-dem-simulator'
+				os.system('svn move %s %s'%(rootf,newDir))
+				#print rootf,newDir
+		elif action=='pkg-*/*/*/*':
+			# target structure:
+			# {DataClass,Engine}/*/*.?pp
+			# {RenderingEngine,PreProcessor,Container}/*.?pp
+			deep2=re.match(r'(.*)/pkg/([^/]+)/(Engine|DataClass|RenderingEngine)/([^/]*)/([^/]*)/?(.*)$',rootf)
+			deep1=re.match(r'(.*)/pkg/([^/]+)/(PreProcessor|Container)/([^/]*)/([^/]*)/?(.*)$',rootf)
+			cmd=None
+			if deep2:
+				gg=deep2.groups()
+				## gg[4] will be skipped
+				if len(gg[5])==0: # directory
+					# replace any references to it in SConscript files
+					f=&quot;%s/pkg/%s/SConscript&quot;%(gg[0],gg[1])
+					cmd=&quot;perl -pi~ -e's@(%s/%s)/%s([^.])@\\1\\2@' %s&quot;%(gg[2],gg[3],gg[4],f)
+				else:
+					newFile=&quot;%s/pkg/%s/%s/%s/%s&quot;%(gg[0],gg[1],gg[2],gg[3],gg[5])
+					cmd=&quot;svn move %s %s&quot;%(rootf,newFile)
+			elif deep1:
+				gg=deep1.groups()
+				## gg[3] and gg[4] will be skipped
+				if len(gg[5])==0: #dir
+					f=&quot;%s/pkg/%s/SConscript&quot;%(gg[0],gg[1])
+					cmd=&quot;perl -pi~ -e's@(%s)/%s/%s([^.])@\\1\\2@' %s&quot;%(gg[2],gg[3],gg[4],f)
+				else:
+					newFile=&quot;%s/pkg/%s/%s/%s&quot;%(gg[0],gg[1],gg[2],gg[5])
+					cmd=&quot;svn move %s %s&quot;%(rootf,newFile)
+			if cmd:
+				if deep2 and cmd[0]=='p': print cmd
+				#os.system(cmd)
+			#	print cmd
+
+
+
+
+


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000072.html">[Yade-commits] r1105 - in branches/scons-layout: . core extra extra/clump extra/spherical-dem-simulator gui gui/qt lib lib/computational-geometry lib/factory lib/multimethods lib/opengl lib/serialization lib/serialization-bin lib/serialization-qt lib/serialization-xml pkg/common pkg/common/Container/BodyContainer/BodyAssocVector pkg/common/Container/BodyContainer/BodyRedirectionVector pkg/common/Container/InteractionContainer/InteractionHashMap pkg/common/Container/InteractionContainer/InteractionVecSet pkg/common/Container/PhysicalActionContainer/PhysicalActionVectorVector pkg/common/DataClass/BoundingVolume/AABB pkg/common/DataClass/BoundingVolume/BoundingSphere pkg/common/DataClass/GeometricalModel/Box pkg/common/DataClass/GeometricalModel/Mesh2D pkg/common/DataClass/GeometricalModel/Quadrilateral pkg/common/DataClass/GeometricalModel/Sphere pkg/common/DataClass/GeometricalModel/Tetrahedron pkg/common/DataClass/InteractingGeometry/InteractingBox pkg/common/DataClass/Interacting! Geometry/InteractingSphere pkg/common/DataClass/InteractingGeometry/MetaInteractingGeometry pkg/common/DataClass/InteractionGeometry/ClosestFeatures pkg/common/DataClass/InteractionPhysics/SimpleElasticInteraction pkg/common/DataClass/PhysicalAction/Force pkg/common/DataClass/PhysicalAction/Momentum pkg/common/DataClass/PhysicalParameters/ParticleParameters pkg/common/DataClass/PhysicalParameters/RigidBodyParameters pkg/common/Engine/DeusExMachina/DisplacementEngine pkg/common/Engine/DeusExMachina/ForceEngine pkg/common/Engine/DeusExMachina/GravityEngine pkg/common/Engine/DeusExMachina/RotationEngine pkg/common/Engine/DeusExMachina/TranslationEngine pkg/common/Engine/EngineUnit/ElasticBodySimpleRelationship pkg/common/Engine/EngineUnit/LeapFrogOrientationIntegrator pkg/common/Engine/EngineUnit/LeapFrogPositionIntegrator pkg/common/Engine/EngineUnit/MetaInteractingGeometry2AABB pkg/common/Engine/EngineUnit/NewtonsMomentumLaw pkg/common/Engine/MetaEngine/BoundingVolumeMetaEng! ine pkg/common/Engine/MetaEngine/GeometricalModelMetaEngine pk! g/common
</A></li>
	<LI>Next message: <A HREF="000073.html">[Yade-commits] r1107 - in branches/scons-layout: extra gui pkg/common pkg/common/Container pkg/common/Container/BodyContainer/BodyAssocVector pkg/common/Container/BodyContainer/BodyRedirectionVector pkg/common/Container/InteractionContainer/InteractionHashMap pkg/common/Container/InteractionContainer/InteractionVecSet pkg/common/Container/PhysicalActionContainer/PhysicalActionVectorVector pkg/common/DataClass/BoundingVolume pkg/common/DataClass/BoundingVolume/AABB pkg/common/DataClass/BoundingVolume/BoundingSphere pkg/common/DataClass/GeometricalModel pkg/common/DataClass/GeometricalModel/Box pkg/common/DataClass/GeometricalModel/Mesh2D pkg/common/DataClass/GeometricalModel/Quadrilateral pkg/common/DataClass/GeometricalModel/Sphere pkg/common/DataClass/GeometricalModel/Tetrahedron pkg/common/DataClass/InteractingGeometry pkg/common/DataClass/InteractingGeometry/InteractingBox pkg/common/DataClass/InteractingGeometry/InteractingSphere pkg/common/DataClass/InteractingGeometry/MetaIn! teractingGeometry pkg/common/DataClass/InteractionGeometry pkg/common/DataClass/InteractionGeometry/ClosestFeatures pkg/common/DataClass/InteractionPhysics pkg/common/DataClass/InteractionPhysics/SimpleElasticInteraction pkg/common/DataClass/PhysicalAction pkg/common/DataClass/PhysicalAction/Force pkg/common/DataClass/PhysicalAction/Momentum pkg/common/DataClass/PhysicalParameters pkg/common/DataClass/PhysicalParameters/ElasticBodyParameters pkg/common/DataClass/PhysicalParameters/ParticleParameters pkg/common/DataClass/PhysicalParameters/RigidBodyParameters pkg/common/Engine/DeusExMachina pkg/common/Engine/DeusExMachina/DisplacementEngine pkg/common/Engine/DeusExMachina/ForceEngine pkg/common/Engine/DeusExMachina/GravityEngine pkg/common/Engine/DeusExMachina/RotationEngine pkg/common/Engine/DeusExMachina/TranslationEngine pkg/common/Engine/EngineUnit pkg/common/Engine/EngineUnit/CundallNonViscousForceDamping pkg/common/Engine/EngineUnit/CundallNonViscousMomentumDamping pkg! /common/Engine/EngineUnit/ElasticBodySimpleRelationship pkg/co! mmon/Eng
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67">[ date ]</a>
              <a href="thread.html#67">[ thread ]</a>
              <a href="subject.html#67">[ subject ]</a>
              <a href="author.html#67">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/yade-commits">More information about the Yade-commits
mailing list</a><br>
</body></html>
