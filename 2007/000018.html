<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Yade-commits] r1053 - in trunk: yade-core/src/yade yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine yade-packages/yade-package-common/src/RenderingEngine yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction! yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer yade-packages/yade-package-dem/src/RenderingEngine yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/Sprin! gGeometry yade-packages/yade-package-mass-spring/src/DataClass! /Interac
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/yade-commits/2007/index.html" >
   <LINK REL="made" HREF="mailto:yade-commits%40lists.berlios.de?Subject=Re%3A%20%5BYade-commits%5D%20r1053%20-%20in%20trunk%3A%20yade-core/src/yade%0A%20yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap%0A%20yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet%0A%20yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures%0A%20yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction%0A%20yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine%0A%20yade-packages/yade-package-common/src/RenderingEngine%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction%21%0A%20yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics%0A%20yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer%0A%20yade-packages/yade-package-dem/src/RenderingEngine%0A%20yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry%0A%20yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring%0A%20yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency%0A%20yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/Sprin%21%0A%20gGeometry%20yade-packages/yade-package-mass-spring/src/DataClass%21%20/Interac&In-Reply-To=%3C200702011645.l11Gj66V012282%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000017.html">
   <LINK REL="Next"  HREF="000019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Yade-commits] r1053 - in trunk: yade-core/src/yade yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine yade-packages/yade-package-common/src/RenderingEngine yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction! yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer yade-packages/yade-package-dem/src/RenderingEngine yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/Sprin! gGeometry yade-packages/yade-package-mass-spring/src/DataClass! /Interac</H1>
    <B>cosurgi at BerliOS</B> 
    <A HREF="mailto:yade-commits%40lists.berlios.de?Subject=Re%3A%20%5BYade-commits%5D%20r1053%20-%20in%20trunk%3A%20yade-core/src/yade%0A%20yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap%0A%20yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet%0A%20yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures%0A%20yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction%0A%20yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine%0A%20yade-packages/yade-package-common/src/RenderingEngine%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics%0A%20yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction%21%0A%20yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction%0A%20yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics%0A%20yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer%0A%20yade-packages/yade-package-dem/src/RenderingEngine%0A%20yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry%0A%20yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring%0A%20yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency%0A%20yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/Sprin%21%0A%20gGeometry%20yade-packages/yade-package-mass-spring/src/DataClass%21%20/Interac&In-Reply-To=%3C200702011645.l11Gj66V012282%40sheep.berlios.de%3E"
       TITLE="[Yade-commits] r1053 - in trunk: yade-core/src/yade yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine yade-packages/yade-package-common/src/RenderingEngine yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction! yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer yade-packages/yade-package-dem/src/RenderingEngine yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/Sprin! gGeometry yade-packages/yade-package-mass-spring/src/DataClass! /Interac">cosurgi at mail.berlios.de
       </A><BR>
    <I>Thu Feb  1 17:45:06 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000017.html">[Yade-commits] r1052 - in trunk/yade-packages:	yade-package-dem/src/Engine/StandAloneEngine	yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer	yade-package-lattice/src/RenderingEngine/GLDrawLatticeBeamState
</A></li>
        <LI>Next message: <A HREF="000019.html">[Yade-commits] r1054 - in trunk: yade-guis/yade-gui-qt/src/QtGUI	yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere	yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine	yade-packages/yade-package-dem/src/Engine/StandAloneEngine/ElasticCohesiveLaw	yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer	yade-packages/yade-package-dem/src/PreProcessor	yade-packages/yade-package-dem/src/PreProcessor/ThreePointBending	yade-packages/yade-package-dem/src/RenderingEngine	yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSDECLinkGeometry	yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18">[ date ]</a>
              <a href="thread.html#18">[ thread ]</a>
              <a href="subject.html#18">[ subject ]</a>
              <a href="author.html#18">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: cosurgi
Date: 2007-02-01 17:45:03 +0100 (Thu, 01 Feb 2007)
New Revision: 1053

Added:
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.cpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.hpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.pro
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawInteractionGeometry.pro
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawInteractionPhysics.pro
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.cpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.hpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.pro
   trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionGeometryFunctor.hpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionPhysicsFunctor.hpp
   trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/
   trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.cpp
   trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.hpp
   trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.pro
Modified:
   trunk/yade-core/src/yade/InteractionContainer.hpp
   trunk/yade-core/src/yade/InteractionGeometry.hpp
   trunk/yade-core/src/yade/InteractionPhysics.hpp
   trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap/InteractionHashMap.cpp
   trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet/InteractionVecSet.cpp
   trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.cpp
   trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.hpp
   trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.cpp
   trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.hpp
   trunk/yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine/DisplacementEngine.cpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere/GLDrawSphere.cpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.cpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.hpp
   trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.pro
   trunk/yade-packages/yade-package-common/src/RenderingEngine/RenderingEngine.pro
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.cpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.hpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.cpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.hpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.cpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.hpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.cpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.hpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.cpp
   trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.hpp
   trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.cpp
   trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.pro
   trunk/yade-packages/yade-package-dem/src/RenderingEngine/RenderingEngine.pro
   trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.cpp
   trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.hpp
   trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.cpp
   trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.hpp
   trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.cpp
   trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.hpp
   trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.cpp
   trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.hpp
   trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.cpp
   trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.hpp
Log:

In this commit I made Interactions drawable by GLDraw*, and I added three
example GLDraws for Interactions:

- GLDrawClosestFeatures - it is a very simple GLDraw - just plots the vector of
  two overlapping bodies, the closest feature. A body displaced by it, will
  stop overlapping with the other body.

- GLDrawSimpleElasticInteraction - it prints a &quot;kn&quot; of the interaction. It may
  be useful if someone wants to PRINT data on the screen about interactions.

- GLDrawSpheresContactGeometry - this is most interesting, it draws a box
  between two interacting spheres, and it's size corresponds to the force
  between them. With it it is simple to see how the force paths.
  It uses only a normal force, not shear force

IMPORTANT: this is a fairly big change: *EVERY* class that inherits from
InteractionPhysics or InteractionGeometry had to be modified:

  1. write constructor in .hpp file
  2. write REGISTER_CLASS_INDEX(this class,its base class); macro in .hpp file
  3. write createIndex(); call inside constructor in .cpp file

For example look into AABB.hpp AABB.cpp to see how it must look like.

If you want to import some of your classess, you must make those modifications
to your interaction classes.



Modified: trunk/yade-core/src/yade/InteractionContainer.hpp
===================================================================
--- trunk/yade-core/src/yade/InteractionContainer.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-core/src/yade/InteractionContainer.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -13,6 +13,7 @@
 
 #include &lt;yade/yade-lib-serialization/Serializable.hpp&gt;
 #include &quot;InteractionContainerIteratorPointer.hpp&quot;
+#include &lt;boost/thread/mutex.hpp&gt;
 
 class Interaction;
 
@@ -21,6 +22,8 @@
 class InteractionContainer : public Serializable
 {
 	public :
+		boost::mutex	drawloopmutex; // FIXME a hack, containers have to be rewritten lock-free.
+
 		InteractionContainer() { interaction.clear(); };
 		virtual ~InteractionContainer() {};
 

Modified: trunk/yade-core/src/yade/InteractionGeometry.hpp
===================================================================
--- trunk/yade-core/src/yade/InteractionGeometry.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-core/src/yade/InteractionGeometry.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -9,12 +9,16 @@
 #ifndef INTERACTIONGEOMETRY_HPP
 #define INTERACTIONGEOMETRY_HPP
 
+#include &lt;yade/yade-lib-base/yadeWm3Extra.hpp&gt;
 #include &lt;yade/yade-lib-serialization/Serializable.hpp&gt;
+#include &lt;yade/yade-lib-multimethods/Indexable.hpp&gt;
 
-class InteractionGeometry : public Serializable
+class InteractionGeometry : public Serializable, public Indexable
 {
 	REGISTER_CLASS_NAME(InteractionGeometry);
-	REGISTER_BASE_CLASS_NAME(Serializable);
+	REGISTER_BASE_CLASS_NAME(Serializable Indexable);
+	
+	REGISTER_INDEX_COUNTER(InteractionGeometry);
 };
 
 REGISTER_SERIALIZABLE(InteractionGeometry,false);

Modified: trunk/yade-core/src/yade/InteractionPhysics.hpp
===================================================================
--- trunk/yade-core/src/yade/InteractionPhysics.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-core/src/yade/InteractionPhysics.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -9,13 +9,16 @@
 #ifndef INTERACTIONPHYSICS_HPP
 #define INTERACTIONPHYSICS_HPP
 
+#include &lt;yade/yade-lib-base/yadeWm3Extra.hpp&gt;
 #include &lt;yade/yade-lib-serialization/Serializable.hpp&gt;
+#include &lt;yade/yade-lib-multimethods/Indexable.hpp&gt;
 
-class InteractionPhysics : public Serializable
+class InteractionPhysics : public Serializable, public Indexable
 {
 	REGISTER_CLASS_NAME(InteractionPhysics);
-	REGISTER_BASE_CLASS_NAME(Serializable);
+	REGISTER_BASE_CLASS_NAME(Serializable Indexable);
 
+	REGISTER_INDEX_COUNTER(InteractionPhysics);
 };
 
 REGISTER_SERIALIZABLE(InteractionPhysics,false);

Modified: trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap/InteractionHashMap.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap/InteractionHashMap.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionHashMap/InteractionHashMap.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -23,6 +23,8 @@
 
 bool InteractionHashMap::insert(shared_ptr&lt;Interaction&gt;&amp; i)
 {
+	boost::mutex::scoped_lock lock(drawloopmutex);
+
 	unsigned int id1 = i-&gt;getId1();
 	unsigned int id2 = i-&gt;getId2();
 	if (id1&gt;id2)
@@ -41,12 +43,16 @@
 
 void InteractionHashMap::clear()
 {
+	boost::mutex::scoped_lock lock(drawloopmutex);
+
 	interactions.clear();
 }
 
 
 bool InteractionHashMap::erase(unsigned int id1,unsigned int id2)
 {
+	boost::mutex::scoped_lock lock(drawloopmutex);
+
 	if (id1&gt;id2)
 		swap(id1,id2);
 

Modified: trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet/InteractionVecSet.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet/InteractionVecSet.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/Container/InteractionContainer/InteractionVecSet/InteractionVecSet.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -26,6 +26,8 @@
 
 bool InteractionVecSet::insert(shared_ptr&lt;Interaction&gt;&amp; i)
 {
+	boost::mutex::scoped_lock lock(drawloopmutex);
+
 	unsigned int id1 = i-&gt;getId1();
 	unsigned int id2 = i-&gt;getId2();
 
@@ -54,6 +56,8 @@
 
 void InteractionVecSet::clear()
 {
+	boost::mutex::scoped_lock lock(drawloopmutex);
+
 	interactions.clear();
 	currentSize=0;
 }
@@ -61,6 +65,8 @@
 
 bool InteractionVecSet::erase(unsigned int id1,unsigned int id2)
 {
+	boost::mutex::scoped_lock lock(drawloopmutex);
+
 	if (id1&gt;id2)
 		swap(id1,id2);
 

Modified: trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -11,6 +11,7 @@
 
 ClosestFeatures::ClosestFeatures() : InteractionGeometry()
 {
+	createIndex();
 	closestsPoints.clear();
 }
 

Modified: trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/DataClass/InteractionGeometry/ClosestFeatures/ClosestFeatures.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -27,6 +27,7 @@
 	REGISTER_CLASS_NAME(ClosestFeatures);
 	REGISTER_BASE_CLASS_NAME(InteractionGeometry);
 
+	REGISTER_CLASS_INDEX(ClosestFeatures,InteractionGeometry);
 };
 
 REGISTER_SERIALIZABLE(ClosestFeatures,false);

Modified: trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -9,6 +9,11 @@
 #include &quot;SimpleElasticInteraction.hpp&quot;
 
 
+SimpleElasticInteraction::SimpleElasticInteraction()
+{
+	createIndex();
+}
+
 SimpleElasticInteraction::~SimpleElasticInteraction()
 {
 }

Modified: trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction/SimpleElasticInteraction.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -17,6 +17,7 @@
 	public :
 		Real		 kn;				// normal elastic constant.
 	
+		SimpleElasticInteraction();
 		virtual ~SimpleElasticInteraction();
 	protected :
 		virtual void registerAttributes();
@@ -24,6 +25,8 @@
 	REGISTER_CLASS_NAME(SimpleElasticInteraction);
 	REGISTER_BASE_CLASS_NAME(InteractionPhysics);
 
+	REGISTER_CLASS_INDEX(SimpleElasticInteraction,InteractionPhysics);
+
 };
 
 REGISTER_SERIALIZABLE(SimpleElasticInteraction,false);

Modified: trunk/yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine/DisplacementEngine.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine/DisplacementEngine.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/Engine/DeusExMachina/DisplacementEngine/DisplacementEngine.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -12,7 +12,16 @@
 void DisplacementEngine::postProcessAttributes(bool deserializing)
 {
 	if(deserializing)
+	{
 		translationAxis.Normalize();
+		/*
+		if(displacement==0)
+			displacement=2e-10;
+		else
+			displacement=0;
+		*/
+		std::cerr &lt;&lt; &quot;displacement: &quot; &lt;&lt; displacement &lt;&lt; &quot;\n&quot;;
+	}
 }
 
 

Modified: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere/GLDrawSphere.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere/GLDrawSphere.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere/GLDrawSphere.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -123,6 +123,7 @@
 		Vector3r v = (v1+v2+v3)/3.0;
 		Real angle = atan(v[2]/v[0])/v.Length();
 
+		// FIXME - another parameter to GLDraw* to allow to disable that stripe on the sphere
 		GLfloat matAmbient[4];
 
 		if (angle&gt;-Mathr::PI/6.0 &amp;&amp; angle&lt;=Mathr::PI/6.0)

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,45 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at mail.berlios.de</A>                                               *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include &quot;GLDrawClosestFeatures.hpp&quot;
+#include &quot;ClosestFeatures.hpp&quot;
+
+
+#include &lt;yade/yade-lib-opengl/OpenGLWrapper.hpp&gt;
+
+
+void GLDrawClosestFeatures::go(
+		const shared_ptr&lt;InteractionGeometry&gt;&amp; ig,
+		const shared_ptr&lt;Interaction&gt;&amp;,
+		const shared_ptr&lt;Body&gt;&amp; b1,
+		const shared_ptr&lt;Body&gt;&amp; b2,
+		bool wireFrame)
+{
+	ClosestFeatures* p = static_cast&lt;ClosestFeatures*&gt;(ig.get());
+//	FIXME: so there must be a way for *not* storing the color inside those classes like BodyBoundingVolume and BodyState
+//	       and simultaneously easy to set up the colors from the GUI according to some usful criterions:
+//	          - to which group it belongs
+//	          - to reflect some features of the drawed element
+//	          - according to some certaion selection
+//	          - etc...
+	//glColor3v(bv-&gt;diffuseColor);
+	glTranslatev(p-&gt;closestsPoints[0].first);
+	
+	// FIXME - another problem with scaling of stuff to be drawn
+	//
+	//glScale(2*aabb-&gt;halfSize[0],2*aabb-&gt;halfSize[1],2*aabb-&gt;halfSize[2]);
+	glDisable(GL_LIGHTING);
+
+	// too lazy to write a loop....
+	glBegin(GL_LINES);
+		glColor3(1.0,0.0,0.0);
+		glVertex3(0.0,0.0,0.0);
+		glVertex3v(p-&gt;closestsPoints[0].second-p-&gt;closestsPoints[0].first);
+	glEnd();
+}
+

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,27 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at mail.berlios.de</A>                                               *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef GLDRAW_CLOSEST_FEATURES_HPP
+#define GLDRAW_CLOSEST_FEATURES_HPP
+
+#include &quot;GLDrawInteractionGeometryFunctor.hpp&quot;
+
+class GLDrawClosestFeatures : public GLDrawInteractionGeometryFunctor
+{
+	public :
+		virtual void go(const shared_ptr&lt;InteractionGeometry&gt;&amp;,const shared_ptr&lt;Interaction&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,bool wireFrame);
+
+	RENDERS(ClosestFeatures);
+	REGISTER_CLASS_NAME(GLDrawClosestFeatures);
+	REGISTER_BASE_CLASS_NAME(GLDrawInteractionGeometryFunctor);
+};
+
+REGISTER_SERIALIZABLE(GLDrawClosestFeatures,false);
+
+#endif
+

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.pro
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawClosestFeatures/GLDrawClosestFeatures.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,26 @@
+isEmpty ( YADE_QMAKE_PATH ) {
+error( &quot;YADE_QMAKE_PATH internal qmake variable is not set, you should run for example qmake YADE_QMAKE_PATH=/usr/local, this will not work from inside kdevelop (when they will fix it?)&quot; )
+}
+
+
+LIBS += -lClosestFeatures \
+        -lyade-lib-opengl \
+        -rdynamic 
+INCLUDEPATH += $${YADE_QMAKE_PATH}/include/ \
+               ../../../DataClass/InteractionGeometry/ClosestFeatures \
+               ../../../RenderingEngine/OpenGLRenderingEngine 
+QMAKE_LIBDIR = ../../../../bin \
+               $${YADE_QMAKE_PATH}/lib/yade/yade-libs/ 
+QMAKE_CXXFLAGS_RELEASE += -lpthread \
+                          -pthread 
+QMAKE_CXXFLAGS_DEBUG += -lpthread \
+                        -pthread 
+DESTDIR = ../../../../bin 
+CONFIG += debug \
+          thread \
+          warn_on \
+          dll 
+TEMPLATE = lib 
+HEADERS += GLDrawClosestFeatures.hpp 
+SOURCES += GLDrawClosestFeatures.cpp 
+QMAKE_RUN_CXX_IMP = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $(shell pwd)/$&lt;

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawInteractionGeometry.pro
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawInteractionGeometry.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionGeometry/GLDrawInteractionGeometry.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,13 @@
+isEmpty ( YADE_QMAKE_PATH ) {
+error( &quot;YADE_QMAKE_PATH internal qmake variable is not set, you should run for example qmake YADE_QMAKE_PATH=/usr/local, this will not work from inside kdevelop (when they will fix it?)&quot; )
+}
+
+
+SUBDIRS += GLDrawClosestFeatures
+CONFIG += debug \
+          thread \
+warn_on
+TEMPLATE = subdirs
+INCLUDEPATH += $${YADE_QMAKE_PATH}/include
+
+QMAKE_RUN_CXX_IMP = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $(shell pwd)/$&lt;

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawInteractionPhysics.pro
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawInteractionPhysics.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawInteractionPhysics.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,13 @@
+isEmpty ( YADE_QMAKE_PATH ) {
+error( &quot;YADE_QMAKE_PATH internal qmake variable is not set, you should run for example qmake YADE_QMAKE_PATH=/usr/local, this will not work from inside kdevelop (when they will fix it?)&quot; )
+}
+
+
+SUBDIRS += GLDrawSimpleElasticInteraction
+CONFIG += debug \
+          thread \
+warn_on
+TEMPLATE = subdirs
+INCLUDEPATH += $${YADE_QMAKE_PATH}/include
+
+QMAKE_RUN_CXX_IMP = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $(shell pwd)/$&lt;

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,42 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at mail.berlios.de</A>                                               *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include &quot;GLDrawSimpleElasticInteraction.hpp&quot;
+#include &quot;SimpleElasticInteraction.hpp&quot;
+
+
+#include &lt;yade/yade-lib-opengl/OpenGLWrapper.hpp&gt;
+
+
+void GLDrawSimpleElasticInteraction::go(
+		const shared_ptr&lt;InteractionPhysics&gt;&amp; ip,
+		const shared_ptr&lt;Interaction&gt;&amp;,
+		const shared_ptr&lt;Body&gt;&amp; b1,
+		const shared_ptr&lt;Body&gt;&amp; b2,
+		bool wireFrame)
+{
+	SimpleElasticInteraction* p = static_cast&lt;SimpleElasticInteraction*&gt;(ip.get());
+//	FIXME: so there must be a way for *not* storing the color inside those classes like BodyBoundingVolume and BodyState
+//	       and simultaneously easy to set up the colors from the GUI according to some usful criterions:
+//	          - to which group it belongs
+//	          - to reflect some features of the drawed element
+//	          - according to some certaion selection
+//	          - etc...
+	//glColor3v(bv-&gt;diffuseColor);
+	Vector3r mid = 0.5*(b1-&gt;physicalParameters-&gt;se3.position+b2-&gt;physicalParameters-&gt;se3.position);
+	glTranslatev(mid);
+	glColor3(1.0,0.0,0.0);
+	
+	glPushMatrix();
+	glRasterPos2i(0,0);
+	std::string str=std::string(&quot;  kn=&quot;) + boost::lexical_cast&lt;std::string&gt;((float)(p-&gt;kn));
+	for(unsigned int i=0;i&lt;str.length();i++)
+		glutBitmapCharacter(GLUT_BITMAP_HELVETICA_12, str[i]);
+	glPopMatrix();
+}
+

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,27 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at mail.berlios.de</A>                                               *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef GLDRAW_SIMPLE_ELASTIC_INTERACTION_HPP
+#define GLDRAW_SIMPLE_ELASTIC_INTERACTION_HPP
+
+#include &quot;GLDrawInteractionPhysicsFunctor.hpp&quot;
+
+class GLDrawSimpleElasticInteraction : public GLDrawInteractionPhysicsFunctor
+{
+	public :
+		virtual void go(const shared_ptr&lt;InteractionPhysics&gt;&amp;,const shared_ptr&lt;Interaction&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,bool wireFrame);
+
+	RENDERS(SimpleElasticInteraction);
+	REGISTER_CLASS_NAME(GLDrawSimpleElasticInteraction);
+	REGISTER_BASE_CLASS_NAME(GLDrawInteractionPhysicsFunctor);
+};
+
+REGISTER_SERIALIZABLE(GLDrawSimpleElasticInteraction,false);
+
+#endif
+

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.pro
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/GLDrawInteractionPhysics/GLDrawSimpleElasticInteraction/GLDrawSimpleElasticInteraction.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,26 @@
+isEmpty ( YADE_QMAKE_PATH ) {
+error( &quot;YADE_QMAKE_PATH internal qmake variable is not set, you should run for example qmake YADE_QMAKE_PATH=/usr/local, this will not work from inside kdevelop (when they will fix it?)&quot; )
+}
+
+
+LIBS += -lSimpleElasticInteraction \
+        -lyade-lib-opengl \
+        -rdynamic 
+INCLUDEPATH += $${YADE_QMAKE_PATH}/include/ \
+               ../../../DataClass/InteractionPhysics/SimpleElasticInteraction \
+               ../../../RenderingEngine/OpenGLRenderingEngine 
+QMAKE_LIBDIR = ../../../../bin \
+               $${YADE_QMAKE_PATH}/lib/yade/yade-libs/ 
+QMAKE_CXXFLAGS_RELEASE += -lpthread \
+                          -pthread 
+QMAKE_CXXFLAGS_DEBUG += -lpthread \
+                        -pthread 
+DESTDIR = ../../../../bin 
+CONFIG += debug \
+          thread \
+          warn_on \
+          dll 
+TEMPLATE = lib 
+HEADERS += GLDrawSimpleElasticInteraction.hpp 
+SOURCES += GLDrawSimpleElasticInteraction.cpp 
+QMAKE_RUN_CXX_IMP = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $(shell pwd)/$&lt;

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionGeometryFunctor.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionGeometryFunctor.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionGeometryFunctor.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,40 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at berlios.de</A>                                                    *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef GLDRAW_INTERACTION_GEOMETRY_FUNCTOR_HPP
+#define GLDRAW_INTERACTION_GEOMETRY_FUNCTOR_HPP
+
+#include &lt;yade/yade-lib-multimethods/FunctorWrapper.hpp&gt;
+#include &lt;yade/yade-core/InteractionGeometry.hpp&gt;
+#include &lt;yade/yade-core/Body.hpp&gt;
+#include &lt;yade/yade-core/EngineUnit1D.hpp&gt;
+
+
+#define RENDERS(name) 							\
+	public : virtual string renders() const { return #name; };
+
+class GLDrawInteractionGeometryFunctor
+	: public EngineUnit1D
+	&lt;
+		void ,
+		TYPELIST_5(const shared_ptr&lt;InteractionGeometry&gt;&amp;, const shared_ptr&lt;Interaction&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, bool)
+	&gt;
+{
+	public : 
+		virtual ~GLDrawInteractionGeometryFunctor() {};
+		virtual string renders() const { std::cerr &lt;&lt; &quot;unregistered gldraw class.\n&quot;; throw; }; // FIXME - replace that with a nice exception
+	
+	REGISTER_CLASS_NAME(GLDrawInteractionGeometryFunctor);
+	REGISTER_BASE_CLASS_NAME(EngineUnit1D);
+};
+
+REGISTER_SERIALIZABLE(GLDrawInteractionGeometryFunctor,false);
+
+#endif //  GLDRAWGEOMETRICALMODELFUNCTOR_HPP
+
+

Added: trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionPhysicsFunctor.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionPhysicsFunctor.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/GLDrawInteractionPhysicsFunctor.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,40 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at berlios.de</A>                                                    *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef GLDRAW_INTERACTION_PHYSICS_FUNCTOR_HPP
+#define GLDRAW_INTERACTION_PHYSICS_FUNCTOR_HPP
+
+#include &lt;yade/yade-lib-multimethods/FunctorWrapper.hpp&gt;
+#include &lt;yade/yade-core/InteractionPhysics.hpp&gt;
+#include &lt;yade/yade-core/Body.hpp&gt;
+#include &lt;yade/yade-core/EngineUnit1D.hpp&gt;
+
+
+#define RENDERS(name) 							\
+	public : virtual string renders() const { return #name; };
+
+class GLDrawInteractionPhysicsFunctor
+	: public EngineUnit1D
+	&lt;
+		void ,
+		TYPELIST_5(const shared_ptr&lt;InteractionPhysics&gt;&amp;, const shared_ptr&lt;Interaction&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, bool) 
+	&gt;
+{
+	public : 
+		virtual ~GLDrawInteractionPhysicsFunctor() {};
+		virtual string renders() const { std::cerr &lt;&lt; &quot;unregistered gldraw class.\n&quot;; throw; }; // FIXME - replace that with a nice exception
+	
+	REGISTER_CLASS_NAME(GLDrawInteractionPhysicsFunctor);
+	REGISTER_BASE_CLASS_NAME(EngineUnit1D);
+};
+
+REGISTER_SERIALIZABLE(GLDrawInteractionPhysicsFunctor,false);
+
+#endif //  GLDRAWGEOMETRICALMODELFUNCTOR_HPP
+
+

Modified: trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.cpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -30,6 +30,9 @@
 	lightPos		= Vector3r(75.0,130.0,0.0);
 	backGroundColor		= Vector3r(0.2,0.2,0.2);
 	
+	drawInteractionGeometry	= false;
+	drawInteractionPhysics	= false;
+	
 	map&lt;string,DynlibDescriptor&gt;::const_iterator di    = Omega::instance().getDynlibsDescriptor().begin();
 	map&lt;string,DynlibDescriptor&gt;::const_iterator diEnd = Omega::instance().getDynlibsDescriptor().end();
 	for(;di!=diEnd;++di)
@@ -44,6 +47,13 @@
 			addGeometricalModelFunctor((*di).first);
 		if (Omega::instance().isInheritingFrom((*di).first,&quot;GLDrawShadowVolumeFunctor&quot;))
 			addShadowVolumeFunctor((*di).first);
+
+	//	InteractionGeometry
+	//	InteractionPhysics
+		if (Omega::instance().isInheritingFrom((*di).first,&quot;GLDrawInteractionGeometryFunctor&quot;))
+			addInteractionGeometryFunctor((*di).first);
+		if (Omega::instance().isInheritingFrom((*di).first,&quot;GLDrawInteractionPhysicsFunctor&quot;))
+			addInteractionPhysicsFunctor((*di).first);
 	}
 
 	postProcessAttributes(true);
@@ -181,6 +191,12 @@
 		renderInteractingGeometry(rootBody);
 	}
 
+	if (drawInteractionGeometry)
+		renderInteractionGeometry(rootBody);
+	
+	if (drawInteractionPhysics)
+		renderInteractionPhysics(rootBody);
+	
 
 /*	shared_ptr&lt;BodyContainer&gt; bodies = rootBody-&gt;bodies;
 	shared_ptr&lt;InteractionContainer&gt;&amp; collisions = rootBody-&gt;transientInteractions;
@@ -412,6 +428,70 @@
 }
 
 
+void OpenGLRenderingEngine::renderInteractionGeometry(const shared_ptr&lt;MetaBody&gt;&amp; rootBody)
+{	
+	{
+		boost::mutex::scoped_lock lock(rootBody-&gt;persistentInteractions-&gt;drawloopmutex);
+
+		InteractionContainer::iterator bi    = rootBody-&gt;persistentInteractions-&gt;begin();
+		InteractionContainer::iterator biEnd = rootBody-&gt;persistentInteractions-&gt;end();
+		for( ; bi!=biEnd ; ++bi)
+		{
+			glPushMatrix();
+			if((*bi)-&gt;interactionGeometry)
+				interactionGeometryDispatcher((*bi)-&gt;interactionGeometry,(*bi),(*(rootBody-&gt;bodies))[(*bi)-&gt;getId1()],(*(rootBody-&gt;bodies))[(*bi)-&gt;getId2()],drawWireFrame);
+			glPopMatrix();
+		}
+	}
+
+	{
+		boost::mutex::scoped_lock lock(rootBody-&gt;transientInteractions-&gt;drawloopmutex);
+
+		InteractionContainer::iterator bi    = rootBody-&gt;transientInteractions-&gt;begin();
+		InteractionContainer::iterator biEnd = rootBody-&gt;transientInteractions-&gt;end();
+		for( ; bi!=biEnd ; ++bi)
+		{
+			glPushMatrix();
+			if((*bi)-&gt;interactionGeometry)
+				interactionGeometryDispatcher((*bi)-&gt;interactionGeometry,(*bi),(*(rootBody-&gt;bodies))[(*bi)-&gt;getId1()],(*(rootBody-&gt;bodies))[(*bi)-&gt;getId2()],drawWireFrame);
+			glPopMatrix();
+		}
+	}
+}
+
+
+void OpenGLRenderingEngine::renderInteractionPhysics(const shared_ptr&lt;MetaBody&gt;&amp; rootBody)
+{	
+	{
+		boost::mutex::scoped_lock lock(rootBody-&gt;persistentInteractions-&gt;drawloopmutex);
+
+		InteractionContainer::iterator bi    = rootBody-&gt;persistentInteractions-&gt;begin();
+		InteractionContainer::iterator biEnd = rootBody-&gt;persistentInteractions-&gt;end();
+		for( ; bi!=biEnd ; ++bi)
+		{
+			glPushMatrix();
+			if((*bi)-&gt;interactionPhysics)
+				interactionPhysicsDispatcher((*bi)-&gt;interactionPhysics,(*bi),(*(rootBody-&gt;bodies))[(*bi)-&gt;getId1()],(*(rootBody-&gt;bodies))[(*bi)-&gt;getId2()],drawWireFrame);
+			glPopMatrix();
+		}
+	}
+
+	{
+		boost::mutex::scoped_lock lock(rootBody-&gt;transientInteractions-&gt;drawloopmutex);
+
+		InteractionContainer::iterator bi    = rootBody-&gt;transientInteractions-&gt;begin();
+		InteractionContainer::iterator biEnd = rootBody-&gt;transientInteractions-&gt;end();
+		for( ; bi!=biEnd ; ++bi)
+		{
+			glPushMatrix();
+			if((*bi)-&gt;interactionPhysics)
+				interactionPhysicsDispatcher((*bi)-&gt;interactionPhysics,(*bi),(*(rootBody-&gt;bodies))[(*bi)-&gt;getId1()],(*(rootBody-&gt;bodies))[(*bi)-&gt;getId2()],drawWireFrame);
+			glPopMatrix();
+		}
+	}
+}
+
+
 void OpenGLRenderingEngine::renderState(const shared_ptr&lt;MetaBody&gt;&amp; rootBody)
 {	
 	BodyContainer::iterator bi    = rootBody-&gt;bodies-&gt;begin();
@@ -465,31 +545,39 @@
 		glTranslatef(se3.position[0],se3.position[1],se3.position[2]);
 		glRotatef(angle*Mathr::RAD_TO_DEG,axis[0],axis[1],axis[2]);
 		if((*bi)-&gt;interactingGeometry &amp;&amp; ( ((*bi)-&gt;getGroupMask() &amp; drawMask) || (*bi)-&gt;getGroupMask()==0 ))
-			interactionGeometryDispatcher((*bi)-&gt;interactingGeometry,(*bi)-&gt;physicalParameters);
+			interactingGeometryDispatcher((*bi)-&gt;interactingGeometry,(*bi)-&gt;physicalParameters);
 		glPopMatrix();
 	}
 	
 	glPushMatrix();
 	if(rootBody-&gt;interactingGeometry)
-		interactionGeometryDispatcher(rootBody-&gt;interactingGeometry,rootBody-&gt;physicalParameters);
+		interactingGeometryDispatcher(rootBody-&gt;interactingGeometry,rootBody-&gt;physicalParameters);
 	glPopMatrix();
 }
 
 
 void OpenGLRenderingEngine::registerAttributes()
 {
-	REGISTER_ATTRIBUTE(lightPos);
-	REGISTER_ATTRIBUTE(backGroundColor);
 	REGISTER_ATTRIBUTE(drawState);
 	REGISTER_ATTRIBUTE(drawBoundingVolume);
 	REGISTER_ATTRIBUTE(drawInteractingGeometry);
 	REGISTER_ATTRIBUTE(drawGeometricalModel);
+	
+	REGISTER_ATTRIBUTE(drawMask);
+	
+	REGISTER_ATTRIBUTE(drawWireFrame);
+
+	REGISTER_ATTRIBUTE(drawInteractionGeometry);
+	REGISTER_ATTRIBUTE(drawInteractionPhysics);
+	
+	REGISTER_ATTRIBUTE(lightPos);
+	REGISTER_ATTRIBUTE(backGroundColor);
+	
+	REGISTER_ATTRIBUTE(drawInside);
+
 	REGISTER_ATTRIBUTE(castShadow);
 	REGISTER_ATTRIBUTE(drawShadowVolumes);
 	REGISTER_ATTRIBUTE(useFastShadowVolume);	
-	REGISTER_ATTRIBUTE(drawWireFrame);
-	REGISTER_ATTRIBUTE(drawInside);
-	REGISTER_ATTRIBUTE(drawMask);
 }
 
 
@@ -503,18 +591,42 @@
 		for(unsigned int i=0;i&lt;boundingVolumeFunctorNames.size();i++)
 			boundingVolumeDispatcher.add1DEntry(boundingVolumeFunctorNames[i][0],boundingVolumeFunctorNames[i][1]);
 			
-		for(unsigned int i=0;i&lt;interactionGeometryFunctorNames.size();i++)
-			interactionGeometryDispatcher.add1DEntry(interactionGeometryFunctorNames[i][0],interactionGeometryFunctorNames[i][1]);
+		for(unsigned int i=0;i&lt;interactingGeometryFunctorNames.size();i++)
+			interactingGeometryDispatcher.add1DEntry(interactingGeometryFunctorNames[i][0],interactingGeometryFunctorNames[i][1]);
 			
 		for(unsigned int i=0;i&lt;geometricalModelFunctorNames.size();i++)
 			geometricalModelDispatcher.add1DEntry(geometricalModelFunctorNames[i][0],geometricalModelFunctorNames[i][1]);
 		
 		for(unsigned int i=0;i&lt;shadowVolumeFunctorNames.size();i++)
 			shadowVolumeDispatcher.add1DEntry(shadowVolumeFunctorNames[i][0],shadowVolumeFunctorNames[i][1]);
+		
+		for(unsigned int i=0;i&lt;interactionGeometryFunctorNames.size();i++)
+			interactionGeometryDispatcher.add1DEntry(interactionGeometryFunctorNames[i][0],interactionGeometryFunctorNames[i][1]);
+			
+		for(unsigned int i=0;i&lt;interactionPhysicsFunctorNames.size();i++)
+			interactionPhysicsDispatcher.add1DEntry(interactionPhysicsFunctorNames[i][0],interactionPhysicsFunctorNames[i][1]);	
 	}
 }
 
 
+void OpenGLRenderingEngine::addInteractionGeometryFunctor(const string&amp; str2)
+{
+	string str1 = (static_pointer_cast&lt;GLDrawInteractionGeometryFunctor&gt;(ClassFactory::instance().createShared(str2)))-&gt;renders();
+	vector&lt;string&gt; v;
+	v.push_back(str1);
+	v.push_back(str2);
+	interactionGeometryFunctorNames.push_back(v);
+}
+
+void OpenGLRenderingEngine::addInteractionPhysicsFunctor(const string&amp; str2)
+{
+	string str1 = (static_pointer_cast&lt;GLDrawInteractionPhysicsFunctor&gt;(ClassFactory::instance().createShared(str2)))-&gt;renders();
+	vector&lt;string&gt; v;
+	v.push_back(str1);
+	v.push_back(str2);
+	interactionPhysicsFunctorNames.push_back(v);
+}
+
 void OpenGLRenderingEngine::addStateFunctor(const string&amp; str2)
 {
 	string str1 = (static_pointer_cast&lt;GLDrawStateFunctor&gt;(ClassFactory::instance().createShared(str2)))-&gt;renders();
@@ -541,7 +653,7 @@
 	vector&lt;string&gt; v;
 	v.push_back(str1);
 	v.push_back(str2);
-	interactionGeometryFunctorNames.push_back(v);
+	interactingGeometryFunctorNames.push_back(v);
 }
 
 

Modified: trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.hpp
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -18,6 +18,8 @@
 #include &quot;GLDrawInteractingGeometryFunctor.hpp&quot;
 #include &quot;GLDrawGeometricalModelFunctor.hpp&quot;
 #include &quot;GLDrawShadowVolumeFunctor.hpp&quot;
+#include &quot;GLDrawInteractionPhysicsFunctor.hpp&quot;
+#include &quot;GLDrawInteractionGeometryFunctor.hpp&quot;
 
 class OpenGLRenderingEngine : public RenderingEngine
 {	
@@ -34,24 +36,31 @@
 				,useFastShadowVolume
 				,drawWireFrame
 				,drawInside
+				,drawInteractionGeometry
+				,drawInteractionPhysics
 		
 				,needInit;
 		int		 current_selection
 				,drawMask;
 
 	private :
-		DynLibDispatcher&lt; PhysicalParameters , GLDrawStateFunctor, void , TYPELIST_1(const shared_ptr&lt;PhysicalParameters&gt;&amp;) &gt; stateDispatcher;
-		DynLibDispatcher&lt; BoundingVolume     , GLDrawBoundingVolumeFunctor, void , TYPELIST_1(const shared_ptr&lt;BoundingVolume&gt;&amp;) &gt; boundingVolumeDispatcher;
-		DynLibDispatcher&lt; InteractingGeometry,GLDrawInteractingGeometryFunctor, void , TYPELIST_2(const shared_ptr&lt;InteractingGeometry&gt;&amp;, const shared_ptr&lt;PhysicalParameters&gt;&amp;) &gt;interactionGeometryDispatcher;
+		DynLibDispatcher&lt; InteractionGeometry , GLDrawInteractionGeometryFunctor, void , TYPELIST_5(const shared_ptr&lt;InteractionGeometry&gt;&amp;, const shared_ptr&lt;Interaction&gt;&amp; , const shared_ptr&lt;Body&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, bool) &gt; interactionGeometryDispatcher;
+		DynLibDispatcher&lt; InteractionPhysics  , GLDrawInteractionPhysicsFunctor,  void , TYPELIST_5(const shared_ptr&lt;InteractionPhysics&gt;&amp; , const shared_ptr&lt;Interaction&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, const shared_ptr&lt;Body&gt;&amp;, bool) &gt; interactionPhysicsDispatcher;
+
+		DynLibDispatcher&lt; PhysicalParameters  , GLDrawStateFunctor,               void , TYPELIST_1(const shared_ptr&lt;PhysicalParameters&gt;&amp;) &gt; stateDispatcher;
+		DynLibDispatcher&lt; BoundingVolume      , GLDrawBoundingVolumeFunctor,      void , TYPELIST_1(const shared_ptr&lt;BoundingVolume&gt;&amp;) &gt; boundingVolumeDispatcher;
+		DynLibDispatcher&lt; InteractingGeometry , GLDrawInteractingGeometryFunctor, void , TYPELIST_2(const shared_ptr&lt;InteractingGeometry&gt;&amp;, const shared_ptr&lt;PhysicalParameters&gt;&amp;) &gt; interactingGeometryDispatcher;
 		// FIXME - in fact it is a 1D dispatcher
-		DynLibDispatcher&lt; GeometricalModel   , GLDrawGeometricalModelFunctor, void , TYPELIST_3(const shared_ptr&lt;GeometricalModel&gt;&amp;, const shared_ptr&lt;PhysicalParameters&gt;&amp;,bool) &gt; geometricalModelDispatcher;
-		DynLibDispatcher&lt; GeometricalModel   , GLDrawShadowVolumeFunctor, void , TYPELIST_3(const shared_ptr&lt;GeometricalModel&gt;&amp;, const shared_ptr&lt;PhysicalParameters&gt;&amp;, const Vector3r&amp; ) &gt; shadowVolumeDispatcher;
+		DynLibDispatcher&lt; GeometricalModel    , GLDrawGeometricalModelFunctor,    void , TYPELIST_3(const shared_ptr&lt;GeometricalModel&gt;&amp;, const shared_ptr&lt;PhysicalParameters&gt;&amp;, bool) &gt; geometricalModelDispatcher;
+		DynLibDispatcher&lt; GeometricalModel    , GLDrawShadowVolumeFunctor,        void , TYPELIST_3(const shared_ptr&lt;GeometricalModel&gt;&amp;, const shared_ptr&lt;PhysicalParameters&gt;&amp;, const Vector3r&amp; ) &gt; shadowVolumeDispatcher;
 
 		vector&lt;vector&lt;string&gt; &gt;  stateFunctorNames;
 		vector&lt;vector&lt;string&gt; &gt;  boundingVolumeFunctorNames;
-		vector&lt;vector&lt;string&gt; &gt;  interactionGeometryFunctorNames;
+		vector&lt;vector&lt;string&gt; &gt;  interactingGeometryFunctorNames;
 		vector&lt;vector&lt;string&gt; &gt;  geometricalModelFunctorNames;
 		vector&lt;vector&lt;string&gt; &gt;  shadowVolumeFunctorNames;
+		vector&lt;vector&lt;string&gt; &gt;  interactionGeometryFunctorNames;
+		vector&lt;vector&lt;string&gt; &gt;  interactionPhysicsFunctorNames;
 
 	public :
 		void addStateFunctor(const string&amp; str);
@@ -59,6 +68,8 @@
 		void addInteractingGeometryFunctor(const string&amp; str);
 		void addGeometricalModelFunctor(const string&amp; str);
 		void addShadowVolumeFunctor(const string&amp; str);
+		void addInteractionGeometryFunctor(const string&amp; str);
+		void addInteractionPhysicsFunctor(const string&amp; str);
 			
 		OpenGLRenderingEngine();
 		virtual ~OpenGLRenderingEngine();
@@ -69,6 +80,8 @@
 	
 	private :
 		void renderGeometricalModel(const shared_ptr&lt;MetaBody&gt;&amp; rootBody);
+		void renderInteractionPhysics(const shared_ptr&lt;MetaBody&gt;&amp; rootBody);
+		void renderInteractionGeometry(const shared_ptr&lt;MetaBody&gt;&amp; rootBody);
 		void renderState(const shared_ptr&lt;MetaBody&gt;&amp; rootBody);
 		void renderBoundingVolume(const shared_ptr&lt;MetaBody&gt;&amp; rootBody);
 		void renderInteractingGeometry(const shared_ptr&lt;MetaBody&gt;&amp; rootBody);

Modified: trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.pro
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine/OpenGLRenderingEngine.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -7,6 +7,8 @@
            GLDrawGeometricalModelFunctor.hpp \
            GLDrawInteractingGeometryFunctor.hpp \
            GLDrawShadowVolumeFunctor.hpp \
+	   GLDrawInteractionPhysicsFunctor.hpp \
+	   GLDrawInteractionGeometryFunctor.hpp \
 	   GLDrawStateFunctor.hpp \
            OpenGLRenderingEngine.hpp 
 

Modified: trunk/yade-packages/yade-package-common/src/RenderingEngine/RenderingEngine.pro
===================================================================
--- trunk/yade-packages/yade-package-common/src/RenderingEngine/RenderingEngine.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-common/src/RenderingEngine/RenderingEngine.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -7,6 +7,8 @@
            GLDrawGeometricalModel \
            GLDrawInteractingGeometry \
            GLDrawShadowVolume \
+	   GLDrawInteractionGeometry \
+	   GLDrawInteractionPhysics \
 	   GLDrawState \
            OpenGLRenderingEngine 
 CONFIG += debug \

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -10,6 +10,7 @@
 
 InteractionOfMyTetrahedron::InteractionOfMyTetrahedron() : InteractionGeometry()
 {
+	createIndex();
 }
 
 

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.hpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/InteractionOfMyTetrahedron/InteractionOfMyTetrahedron.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -75,6 +75,8 @@
 	REGISTER_CLASS_NAME(InteractionOfMyTetrahedron);
 	REGISTER_BASE_CLASS_NAME(InteractionGeometry);
 
+	REGISTER_CLASS_INDEX(InteractionOfMyTetrahedron,InteractionGeometry);
+
 };
 
 REGISTER_SERIALIZABLE(InteractionOfMyTetrahedron,false);

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -10,6 +10,11 @@
 
 #include &quot;SDECLinkGeometry.hpp&quot;
 
+SDECLinkGeometry::SDECLinkGeometry()
+{
+	createIndex();
+}
+
 SDECLinkGeometry::~SDECLinkGeometry()
 {
 }

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.hpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SDECLinkGeometry/SDECLinkGeometry.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -14,11 +14,11 @@
 #include &lt;Wm3Vector3.h&gt;
 #include &lt;yade/yade-lib-base/yadeWm3.hpp&gt;
 #include &lt;Wm3Quaternion.h&gt;
-#include &lt;yade/yade-lib-base/yadeWm3.hpp&gt;
 
 class SDECLinkGeometry : public InteractionGeometry
 {
 	public :
+		SDECLinkGeometry();
 		virtual ~SDECLinkGeometry();
 
 		Real		 radius1 // FIXME : lots of stuff is the same as in SpheresContactGeometry, so it should inherit from it.
@@ -28,8 +28,11 @@
 
 	protected :
 		void registerAttributes();
+
 	REGISTER_CLASS_NAME(SDECLinkGeometry);
 	REGISTER_BASE_CLASS_NAME(InteractionGeometry);
+
+	REGISTER_CLASS_INDEX(SDECLinkGeometry,InteractionGeometry);
 };
 
 REGISTER_SERIALIZABLE(SDECLinkGeometry,false);

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -10,11 +10,12 @@
 
 #include &quot;SpheresContactGeometry.hpp&quot;
 
-// SpheresContactGeometry::SpheresContactGeometry() : InteractionGeometry()
-// {
-// }
-// 
-// 
+SpheresContactGeometry::SpheresContactGeometry() : InteractionGeometry()
+{
+	createIndex();
+}
+ 
+ 
 SpheresContactGeometry::~SpheresContactGeometry ()
 {
 }

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.hpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionGeometry/SpheresContactGeometry/SpheresContactGeometry.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -24,12 +24,15 @@
 				,radius2
 				,penetrationDepth;
 
+		SpheresContactGeometry();
 		virtual ~SpheresContactGeometry();
 
 	protected :
 		virtual void registerAttributes();
 	REGISTER_CLASS_NAME(SpheresContactGeometry);
 	REGISTER_BASE_CLASS_NAME(InteractionGeometry);
+
+	REGISTER_CLASS_INDEX(SpheresContactGeometry,InteractionGeometry);
 };
 
 REGISTER_SERIALIZABLE(SpheresContactGeometry,false);

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -9,6 +9,11 @@
 #include &quot;ElasticContactInteraction.hpp&quot;
 
 
+ElasticContactInteraction::ElasticContactInteraction()
+{
+	createIndex();
+}
+
 ElasticContactInteraction::~ElasticContactInteraction()
 {
 }

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.hpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/ElasticContactInteraction/ElasticContactInteraction.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -14,8 +14,6 @@
 class ElasticContactInteraction : public SimpleElasticInteraction
 {
 	public :
-		ElasticContactInteraction() {};
-
 		Real		// kn				// normal elastic constant. (inside SimpleElasticInteraction)
 				 ks				// shear elastic constant.
 				,initialKn			// initial normal elastic constant.
@@ -28,7 +26,8 @@
 		Vector3r	prevNormal			// unit normal of the contact plane.
 				,normalForce			// normal force applied on a DE
 				,shearForce;			// shear force applied on a DE
-		
+
+		ElasticContactInteraction();
 		virtual ~ElasticContactInteraction();
 	protected :
 		virtual void registerAttributes();
@@ -36,6 +35,8 @@
 	REGISTER_CLASS_NAME(ElasticContactInteraction);
 	REGISTER_BASE_CLASS_NAME(SimpleElasticInteraction);
 
+	REGISTER_CLASS_INDEX(ElasticContactInteraction,SimpleElasticInteraction);
+
 };
 
 REGISTER_SERIALIZABLE(ElasticContactInteraction,false);

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -13,6 +13,7 @@
 
 SDECLinkPhysics::SDECLinkPhysics()
 {
+	createIndex();
 }
 
 SDECLinkPhysics::~SDECLinkPhysics()

Modified: trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.hpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/DataClass/InteractionPhysics/SDECLinkPhysics/SDECLinkPhysics.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -47,6 +47,7 @@
 	REGISTER_CLASS_NAME(SDECLinkPhysics);
 	REGISTER_BASE_CLASS_NAME(InteractionPhysics);
 
+	REGISTER_CLASS_INDEX(SDECLinkPhysics,InteractionPhysics);
 };
 
 REGISTER_SERIALIZABLE(SDECLinkPhysics,false);

Modified: trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -12,6 +12,8 @@
 #include &lt;yade/yade-core/MetaBody.hpp&gt;
 #include &lt;yade/yade-package-common/Force.hpp&gt;
 #include &lt;boost/lexical_cast.hpp&gt;
+#include &lt;yade/yade-lib-base/yadeWm3Extra.hpp&gt;
+//#include &lt;Wm3Vector3r.hpp&gt;
 
 
 GeometricalModelForceColorizer::GeometricalModelForceColorizer () : StandAloneEngine(), actionForce(new Force)
@@ -60,9 +62,21 @@
 			GeometricalModel* gm = body-&gt;geometricalModel.get();
 			unsigned int i = body -&gt; getId();
 			Vector3r force = dynamic_cast&lt;Force*&gt;(ncb-&gt;physicalActions-&gt;find( i , actionForce-&gt;getClassIndex() ) . get() )-&gt;force;
+
 			gm-&gt;diffuseColor[0] = (force[0]-min)/(max-min);
 			gm-&gt;diffuseColor[1] = (force[1]-min)/(max-min);
 			gm-&gt;diffuseColor[2] = (force[2]-min)/(max-min);
+
+		/*
+			//Real val = std::sqrt(force[0]*force[0]+force[1]*force[1]+force[2]*force[2]);
+			Real val = force[2];
+			//Real val = force.squaredLength();
+			//min=0;
+			gm-&gt;diffuseColor[0] = (val-min)/(max-min);
+			gm-&gt;diffuseColor[1] = (val-min)/(max-min);
+			gm-&gt;diffuseColor[2] = (val-min)/(max-min);
+		*/
+
 		}
 
 	}

Modified: trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.pro
===================================================================
--- trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer/GeometricalModelForceColorizer.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -6,6 +6,12 @@
 LIBS += -lRigidBodyParameters \
         -lForce \
         -rdynamic 
+INCLUDEPATH += $${YADE_QMAKE_PATH}/include/ \
+               ../../../DataClass/PhysicalParameters/LatticeNodeParameters \
+               ../../../DataClass/PhysicalParameters/LatticeSetParameters \
+               ../../../DataClass/PhysicalParameters/LatticeBeamParameters \
+               ../../../DataClass/InteractionPhysics/LatticeBeamAngularSpring \
+               ../../../DataClass/InteractionPhysics/NonLocalDependency
 QMAKE_LIBDIR = $${YADE_QMAKE_PATH}/lib/yade/yade-package-common/ \
                $${YADE_QMAKE_PATH}/lib/yade/yade-libs/ 
 QMAKE_CXXFLAGS_RELEASE += -lpthread \

Added: trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.cpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,79 @@
+/*************************************************************************
+*  Copyright (C) 2007 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at mail.berlios.de</A>                                               *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include &quot;GLDrawSpheresContactGeometry.hpp&quot;
+#include &quot;SpheresContactGeometry.hpp&quot;
+#include &quot;SimpleElasticInteraction.hpp&quot;
+#include &quot;ElasticContactInteraction.hpp&quot;
+
+#include &lt;yade/yade-lib-opengl/OpenGLWrapper.hpp&gt;
+
+GLDrawSpheresContactGeometry::GLDrawSpheresContactGeometry() : midMax(0), forceMax(0)
+{
+}
+
+void GLDrawSpheresContactGeometry::go(
+		const shared_ptr&lt;InteractionGeometry&gt;&amp; ig,
+		const shared_ptr&lt;Interaction&gt;&amp; ip,
+		const shared_ptr&lt;Body&gt;&amp; b1,
+		const shared_ptr&lt;Body&gt;&amp; b2,
+		bool wireFrame)
+{
+	SpheresContactGeometry*    sc = static_cast&lt;SpheresContactGeometry*&gt;(ig.get());
+	ElasticContactInteraction* el = static_cast&lt;ElasticContactInteraction*&gt;(ip-&gt;interactionPhysics.get());
+	
+
+	if(wireFrame)
+	{
+		midMax=0;
+		forceMax=0;
+
+		glTranslatev(sc-&gt;contactPoint);
+		glBegin(GL_LINES);
+			glColor3(0.0,1.0,0.0);
+			glVertex3(0.0,0.0,0.0);
+			glVertex3v(-1.0*(sc-&gt;normal*sc-&gt;radius1));
+			glVertex3(0.0,0.0,0.0);
+			glVertex3v( 1.0*(sc-&gt;normal*sc-&gt;radius2));
+		glEnd();
+	}
+	else
+	{
+		Quaternionr q;
+		q.Align(Vector3r(1.0,0.0,0.0),sc-&gt;normal);
+		Vector3r axis;	
+		Real angle;
+		q.ToAxisAngle(axis,angle);
+
+		Real mid = (sc-&gt;radius1 + sc-&gt;radius2);
+		Real dif = (sc-&gt;radius1 - sc-&gt;radius2)*0.5;
+		midMax = std::max(mid,midMax);
+
+		glTranslatev(sc-&gt;contactPoint-(sc-&gt;normal*dif));
+		glRotatef(angle*Mathr::RAD_TO_DEG,axis[0],axis[1],axis[2]);
+		
+	// FIXME - we need a way to give parameters from outside, again.... so curerntly this scale is hardcoded here
+		if( (!ip-&gt;isNew) &amp;&amp; /*ip-&gt;isReal &amp;&amp;*/ ip-&gt;interactionPhysics)
+		{
+			Real force = el-&gt;normalForce.Length()/600;
+			forceMax = std::max(force,forceMax);
+
+			Real scale = midMax*(force/forceMax)*0.2;
+			glScalef(mid,scale,scale);
+		}
+		else
+			glScalef(mid,mid*0.05,mid*0.05);
+		glColor3(0.7,0.7,0.7);
+	// ///////////
+
+		glEnable(GL_LIGHTING);
+		glutSolidCube(1.0);
+
+	}
+}
+

Added: trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.hpp
===================================================================
--- trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,31 @@
+/*************************************************************************
+*  Copyright (C) 2007 by Janek Kozicki                                   *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-commits">cosurgi at mail.berlios.de</A>                                               *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef GLDRAW_SPHERES_CONTACT_GEOMETRY_HPP
+#define GLDRAW_SPHERES_CONTACT_GEOMETRY_HPP
+
+#include &lt;yade/yade-package-common/GLDrawInteractionGeometryFunctor.hpp&gt;
+
+class GLDrawSpheresContactGeometry : public GLDrawInteractionGeometryFunctor
+{	
+	private :
+		Real midMax;
+		Real forceMax;
+	public :
+		GLDrawSpheresContactGeometry();
+		virtual void go(const shared_ptr&lt;InteractionGeometry&gt;&amp;,const shared_ptr&lt;Interaction&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,bool wireFrame);
+
+	RENDERS(SpheresContactGeometry);
+	REGISTER_CLASS_NAME(GLDrawSpheresContactGeometry);
+	REGISTER_BASE_CLASS_NAME(GLDrawInteractionGeometryFunctor);
+};
+
+REGISTER_SERIALIZABLE(GLDrawSpheresContactGeometry,false);
+
+#endif 
+

Added: trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.pro
===================================================================
--- trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry/GLDrawSpheresContactGeometry.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -0,0 +1,33 @@
+isEmpty ( YADE_QMAKE_PATH ) {
+error( &quot;YADE_QMAKE_PATH internal qmake variable is not set, you should run for example qmake YADE_QMAKE_PATH=/usr/local, this will not work from inside kdevelop (when they will fix it?)&quot; )
+}
+
+
+LIBS += -lSpheresContactGeometry \
+        -lElasticContactInteraction \
+	-lSimpleElasticInteraction \
+        -lyade-lib-opengl \
+        -rdynamic 
+INCLUDEPATH += $${YADE_QMAKE_PATH}/include/ \
+               ../../DataClass/InteractionGeometry/SpheresContactGeometry \
+	       ../../DataClass/InteractionPhysics/ElasticContactInteraction \
+	       ../../../../yade-package-common/src/DataClass/InteractionPhysics/SimpleElasticInteraction \
+               ../../RenderingEngine/OpenGLRenderingEngine 
+QMAKE_LIBDIR = ../../../bin \
+               ../../../../yade-package-common/bin \
+               $${YADE_QMAKE_PATH}/lib/yade/yade-libs/ 
+QMAKE_CXXFLAGS_RELEASE += -lpthread \
+                          -pthread 
+QMAKE_CXXFLAGS_DEBUG += -lpthread \
+                        -pthread 
+DESTDIR = ../../../bin 
+CONFIG += debug \
+          thread \
+          warn_on \
+          dll 
+TEMPLATE = lib 
+HEADERS += GLDrawSpheresContactGeometry.hpp 
+SOURCES += GLDrawSpheresContactGeometry.cpp 
+
+QMAKE_RUN_CXX_IMP = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $(shell pwd)/$&lt;
+

Modified: trunk/yade-packages/yade-package-dem/src/RenderingEngine/RenderingEngine.pro
===================================================================
--- trunk/yade-packages/yade-package-dem/src/RenderingEngine/RenderingEngine.pro	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-dem/src/RenderingEngine/RenderingEngine.pro	2007-02-01 16:45:03 UTC (rev 1053)
@@ -3,7 +3,8 @@
 }
 
 
-SUBDIRS += GLDrawInteractingMyTetrahedron
+SUBDIRS += GLDrawInteractingMyTetrahedron \
+           GLDrawSpheresContactGeometry
 
 CONFIG += debug \
           thread \

Modified: trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.cpp
===================================================================
--- trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -23,7 +23,8 @@
 	swirl2			= 0;
 //	offPlaneAngle		= 0;
 	planeSwap180		= false;
-//	createIndex();
+
+	createIndex();
 }
 
 

Modified: trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.hpp
===================================================================
--- trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/LatticeBeamAngularSpring/LatticeBeamAngularSpring.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -38,7 +38,7 @@
 	REGISTER_BASE_CLASS_NAME(InteractionPhysics);
 	
 /// Indexable
-//	REGISTER_CLASS_INDEX(LatticeBeamAngularSpring,InteractionPhysics);
+	REGISTER_CLASS_INDEX(LatticeBeamAngularSpring,InteractionPhysics);
 
 };
 

Modified: trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.cpp
===================================================================
--- trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -11,7 +11,7 @@
 
 NonLocalDependency::NonLocalDependency() : InteractionPhysics()
 {
-//	createIndex();
+	createIndex();
 }
 
 

Modified: trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.hpp
===================================================================
--- trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-lattice/src/DataClass/InteractionPhysics/NonLocalDependency/NonLocalDependency.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -27,7 +27,7 @@
 	REGISTER_BASE_CLASS_NAME(InteractionPhysics);
 	
 /// Indexable
-//	REGISTER_CLASS_INDEX(NonLocalDependency,InteractionPhysics);
+	REGISTER_CLASS_INDEX(NonLocalDependency,InteractionPhysics);
 
 };
 

Modified: trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.cpp
===================================================================
--- trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -8,6 +8,11 @@
 
 #include &quot;SpringGeometry.hpp&quot;
 
+SpringGeometry::SpringGeometry()
+{
+	createIndex();
+}
+
 SpringGeometry::~SpringGeometry()
 {
 }

Modified: trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.hpp
===================================================================
--- trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionGeometry/SpringGeometry/SpringGeometry.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -18,12 +18,15 @@
 	public :
 		Vector3r p1;
 		Vector3r p2;
+		SpringGeometry();
 		virtual ~SpringGeometry();
 	
 	protected :
 		void registerAttributes();
 	REGISTER_CLASS_NAME(SpringGeometry);
 	REGISTER_BASE_CLASS_NAME(InteractionGeometry);
+
+	REGISTER_CLASS_INDEX(SpringGeometry,InteractionGeometry);
 };
 
 REGISTER_SERIALIZABLE(SpringGeometry,false);

Modified: trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.cpp
===================================================================
--- trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -8,6 +8,11 @@
 
 #include &quot;SpringPhysics.hpp&quot;
 
+SpringPhysics::SpringPhysics()
+{
+	createIndex();
+}
+
 SpringPhysics::~SpringPhysics()
 {
 }

Modified: trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.hpp
===================================================================
--- trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-mass-spring/src/DataClass/InteractionPhysics/SpringPhysics/SpringPhysics.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -18,12 +18,15 @@
 				,damping
 				,initialLength;
 
+		SpringPhysics();
 		virtual ~SpringPhysics();
 
 	protected :
 		virtual void registerAttributes();
 	REGISTER_CLASS_NAME(SpringPhysics);
 	REGISTER_BASE_CLASS_NAME(InteractionPhysics);
+
+	REGISTER_CLASS_INDEX(SpringPhysics,InteractionPhysics);
 };
 
 REGISTER_SERIALIZABLE(SpringPhysics,false);

Modified: trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.cpp
===================================================================
--- trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.cpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.cpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -11,7 +11,7 @@
 
 ErrorTolerantContact::ErrorTolerantContact() : InteractionGeometry()
 {
-
+	createIndex();
 }
 
 

Modified: trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.hpp
===================================================================
--- trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.hpp	2007-01-30 17:38:52 UTC (rev 1052)
+++ trunk/yade-packages/yade-package-realtime-rigidbody/src/DataClass/InteractionGeometry/ErrorTolerantContact/ErrorTolerantContact.hpp	2007-02-01 16:45:03 UTC (rev 1053)
@@ -39,7 +39,8 @@
 
 	REGISTER_CLASS_NAME(ErrorTolerantContact);
 	REGISTER_BASE_CLASS_NAME(InteractionGeometry);
-	//REGISTER_CLASS_INDEX(ErrorTolerantContact);
+	
+	REGISTER_CLASS_INDEX(ErrorTolerantContact,InteractionGeometry);
 };
 
 REGISTER_SERIALIZABLE(ErrorTolerantContact,false);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000017.html">[Yade-commits] r1052 - in trunk/yade-packages:	yade-package-dem/src/Engine/StandAloneEngine	yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer	yade-package-lattice/src/RenderingEngine/GLDrawLatticeBeamState
</A></li>
	<LI>Next message: <A HREF="000019.html">[Yade-commits] r1054 - in trunk: yade-guis/yade-gui-qt/src/QtGUI	yade-packages/yade-package-common/src/RenderingEngine/GLDrawGeometricalModel/GLDrawSphere	yade-packages/yade-package-common/src/RenderingEngine/OpenGLRenderingEngine	yade-packages/yade-package-dem/src/Engine/StandAloneEngine/ElasticCohesiveLaw	yade-packages/yade-package-dem/src/Engine/StandAloneEngine/GeometricalModelForceColorizer	yade-packages/yade-package-dem/src/PreProcessor	yade-packages/yade-package-dem/src/PreProcessor/ThreePointBending	yade-packages/yade-package-dem/src/RenderingEngine	yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSDECLinkGeometry	yade-packages/yade-package-dem/src/RenderingEngine/GLDrawSpheresContactGeometry
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18">[ date ]</a>
              <a href="thread.html#18">[ thread ]</a>
              <a href="subject.html#18">[ subject ]</a>
              <a href="author.html#18">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/yade-commits">More information about the Yade-commits
mailing list</a><br>
</body></html>
